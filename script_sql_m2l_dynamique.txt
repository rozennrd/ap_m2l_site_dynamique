DROP DATABASE IF EXISTS M2LDYNAMIQUE

CREATE DATABASE IF NOT EXISTS M2LDYNAMIQUE;
USE M2LDYNAMIQUE;
# -----------------------------------------------------------------------------
#       TABLE : LIGUE
# -----------------------------------------------------------------------------

CREATE TABLE IF NOT EXISTS LIGUE
 (
   IDLIGUE CHAR(32) NOT NULL  ,
   NOMLIGUE CHAR(32) NULL  ,
   SITE CHAR(32) NULL  ,
   DESCRIPTIF CHAR(32) NULL  
   , PRIMARY KEY (IDLIGUE) 
 ) 
 comment = "";

# -----------------------------------------------------------------------------
#       TABLE : FONCTION
# -----------------------------------------------------------------------------

CREATE TABLE IF NOT EXISTS FONCTION
 (
   IDFONC CHAR(32) NOT NULL  ,
   LIBELLE CHAR(32) NULL  
   , PRIMARY KEY (IDFONC) 
 ) 
 comment = "";

# -----------------------------------------------------------------------------
#       TABLE : UTILISATEUR
# -----------------------------------------------------------------------------

CREATE TABLE IF NOT EXISTS UTILISATEUR
 (
   IDUSER CHAR(32) NOT NULL  ,
   IDLIGUE CHAR(32) NULL  ,
   IDFONC CHAR(32) NOT NULL  ,
   IDCLUB CHAR(32) NULL  ,
   NOM CHAR(32) NULL  ,
   PRENOM CHAR(32) NULL  ,
   LOGIN CHAR(32) NULL  ,
   MDP CHAR(32) NULL  ,
   STATUT CHAR(32) NULL  ,
   TYPEUSER CHAR(32) NULL  
   , PRIMARY KEY (IDUSER) 
 ) 
 comment = "";

# -----------------------------------------------------------------------------
#       INDEX DE LA TABLE UTILISATEUR
# -----------------------------------------------------------------------------


CREATE  INDEX I_FK_UTILISATEUR_LIGUE
     ON UTILISATEUR (IDLIGUE ASC);

CREATE  INDEX I_FK_UTILISATEUR_FONCTION
     ON UTILISATEUR (IDFONC ASC);

CREATE  INDEX I_FK_UTILISATEUR_CLUB
     ON UTILISATEUR (IDCLUB ASC);

# -----------------------------------------------------------------------------
#       TABLE : DEPARTEMENT
# -----------------------------------------------------------------------------

CREATE TABLE IF NOT EXISTS DEPARTEMENT
 (
   CODEDEP CHAR(32) NOT NULL  ,
   NOMDEP CHAR(32) NULL  
   , PRIMARY KEY (CODEDEP) 
 ) 
 comment = "";

# -----------------------------------------------------------------------------
#       TABLE : BULLETIN
# -----------------------------------------------------------------------------

CREATE TABLE IF NOT EXISTS BULLETIN
 (
   IDBULLETIN CHAR(32) NOT NULL  ,
   IDCONTRAT CHAR(32) NOT NULL  ,
   MOIS CHAR(32) NULL  ,
   ANNEE CHAR(32) NULL  ,
   BULLETINPDF CHAR(32) NULL  
   , PRIMARY KEY (IDBULLETIN) 
 ) 
 comment = "";

# -----------------------------------------------------------------------------
#       INDEX DE LA TABLE BULLETIN
# -----------------------------------------------------------------------------


CREATE  INDEX I_FK_BULLETIN_CONTRAT
     ON BULLETIN (IDCONTRAT ASC);

# -----------------------------------------------------------------------------
#       TABLE : FORMATION
# -----------------------------------------------------------------------------

CREATE TABLE IF NOT EXISTS FORMATION
 (
   IDFORMA CHAR(32) NOT NULL  ,
   INTITULE CHAR(32) NULL  ,
   DESCRIPTIF CHAR(32) NULL  ,
   DUREE CHAR(32) NULL  ,
   DATEOUVERTUREINSCRIPTIONS CHAR(32) NULL  ,
   DATECLOTUREINSCRIPTION CHAR(32) NULL  ,
   EFFECTIFMAX CHAR(32) NULL  
   , PRIMARY KEY (IDFORMA) 
 ) 
 comment = "";

# -----------------------------------------------------------------------------
#       TABLE : CONTRAT
# -----------------------------------------------------------------------------

CREATE TABLE IF NOT EXISTS CONTRAT
 (
   IDCONTRAT CHAR(32) NOT NULL  ,
   IDUSER CHAR(32) NOT NULL  ,
   DATEDEBUT CHAR(32) NULL  ,
   DATEFIN CHAR(32) NULL  ,
   TYPECONTRAT CHAR(32) NULL  ,
   NBHEURES CHAR(32) NULL  
   , PRIMARY KEY (IDCONTRAT) 
 ) 
 comment = "";

# -----------------------------------------------------------------------------
#       INDEX DE LA TABLE CONTRAT
# -----------------------------------------------------------------------------


CREATE  INDEX I_FK_CONTRAT_UTILISATEUR
     ON CONTRAT (IDUSER ASC);

# -----------------------------------------------------------------------------
#       TABLE : CODEPOS
# -----------------------------------------------------------------------------

CREATE TABLE IF NOT EXISTS CODEPOS
 (
   CODEPOS CHAR(32) NOT NULL  
   , PRIMARY KEY (CODEPOS) 
 ) 
 comment = "";

# -----------------------------------------------------------------------------
#       TABLE : CLUB
# -----------------------------------------------------------------------------

CREATE TABLE IF NOT EXISTS CLUB
 (
   IDCLUB CHAR(32) NOT NULL  ,
   IDLIGUE CHAR(32) NOT NULL  ,
   IDVILLE CHAR(32) NOT NULL  ,
   NOMCLUB CHAR(32) NULL  ,
   ADRESSECLUB CHAR(32) NULL  
   , PRIMARY KEY (IDCLUB) 
 ) 
 comment = "";

# -----------------------------------------------------------------------------
#       INDEX DE LA TABLE CLUB
# -----------------------------------------------------------------------------


CREATE  INDEX I_FK_CLUB_LIGUE
     ON CLUB (IDLIGUE ASC);

CREATE  INDEX I_FK_CLUB_VILLES
     ON CLUB (IDVILLE ASC);

# -----------------------------------------------------------------------------
#       TABLE : VILLES
# -----------------------------------------------------------------------------

CREATE TABLE IF NOT EXISTS VILLES
 (
   IDVILLE CHAR(32) NOT NULL  ,
   CODEDEP CHAR(32) NOT NULL  ,
   NOMVILLE CHAR(32) NULL  
   , PRIMARY KEY (IDVILLE) 
 ) 
 comment = "";

# -----------------------------------------------------------------------------
#       INDEX DE LA TABLE VILLES
# -----------------------------------------------------------------------------


CREATE  INDEX I_FK_VILLES_DEPARTEMENT
     ON VILLES (CODEDEP ASC);

# -----------------------------------------------------------------------------
#       TABLE : DEMANDEINSCRIPTION
# -----------------------------------------------------------------------------

CREATE TABLE IF NOT EXISTS DEMANDEINSCRIPTION
 (
   IDUSER CHAR(32) NOT NULL  ,
   IDFORMA CHAR(32) NOT NULL  ,
   STATUTDEMANDE CHAR(32) NULL  
   , PRIMARY KEY (IDUSER,IDFORMA) 
 ) 
 comment = "";

# -----------------------------------------------------------------------------
#       INDEX DE LA TABLE DEMANDEINSCRIPTION
# -----------------------------------------------------------------------------


CREATE  INDEX I_FK_DEMANDEINSCRIPTION_UTILISATEUR
     ON DEMANDEINSCRIPTION (IDUSER ASC);

CREATE  INDEX I_FK_DEMANDEINSCRIPTION_FORMATION
     ON DEMANDEINSCRIPTION (IDFORMA ASC);

# -----------------------------------------------------------------------------
#       TABLE : CORRESPOND
# -----------------------------------------------------------------------------

CREATE TABLE IF NOT EXISTS CORRESPOND
 (
   CODEPOS CHAR(32) NOT NULL  ,
   IDVILLE CHAR(32) NOT NULL  
   , PRIMARY KEY (CODEPOS,IDVILLE) 
 ) 
 comment = "";

# -----------------------------------------------------------------------------
#       INDEX DE LA TABLE CORRESPOND
# -----------------------------------------------------------------------------


CREATE  INDEX I_FK_CORRESPOND_CODEPOS
     ON CORRESPOND (CODEPOS ASC);

CREATE  INDEX I_FK_CORRESPOND_VILLES
     ON CORRESPOND (IDVILLE ASC);


# -----------------------------------------------------------------------------
#       CREATION DES REFERENCES DE TABLE
# -----------------------------------------------------------------------------


ALTER TABLE UTILISATEUR 
  ADD FOREIGN KEY FK_UTILISATEUR_LIGUE (IDLIGUE)
      REFERENCES LIGUE (IDLIGUE) ;


ALTER TABLE UTILISATEUR 
  ADD FOREIGN KEY FK_UTILISATEUR_FONCTION (IDFONC)
      REFERENCES FONCTION (IDFONC) ;


ALTER TABLE UTILISATEUR 
  ADD FOREIGN KEY FK_UTILISATEUR_CLUB (IDCLUB)
      REFERENCES CLUB (IDCLUB) ;


ALTER TABLE BULLETIN 
  ADD FOREIGN KEY FK_BULLETIN_CONTRAT (IDCONTRAT)
      REFERENCES CONTRAT (IDCONTRAT) ;


ALTER TABLE CONTRAT 
  ADD FOREIGN KEY FK_CONTRAT_UTILISATEUR (IDUSER)
      REFERENCES UTILISATEUR (IDUSER) ;


ALTER TABLE CLUB 
  ADD FOREIGN KEY FK_CLUB_LIGUE (IDLIGUE)
      REFERENCES LIGUE (IDLIGUE) ;


ALTER TABLE CLUB 
  ADD FOREIGN KEY FK_CLUB_VILLES (IDVILLE)
      REFERENCES VILLES (IDVILLE) ;


ALTER TABLE VILLES 
  ADD FOREIGN KEY FK_VILLES_DEPARTEMENT (CODEDEP)
      REFERENCES DEPARTEMENT (CODEDEP) ;


ALTER TABLE DEMANDEINSCRIPTION 
  ADD FOREIGN KEY FK_DEMANDEINSCRIPTION_UTILISATEUR (IDUSER)
      REFERENCES UTILISATEUR (IDUSER) ;


ALTER TABLE DEMANDEINSCRIPTION 
  ADD FOREIGN KEY FK_DEMANDEINSCRIPTION_FORMATION (IDFORMA)
      REFERENCES FORMATION (IDFORMA) ;


ALTER TABLE CORRESPOND 
  ADD FOREIGN KEY FK_CORRESPOND_CODEPOS (CODEPOS)
      REFERENCES CODEPOS (CODEPOS) ;


ALTER TABLE CORRESPOND 
  ADD FOREIGN KEY FK_CORRESPOND_VILLES (IDVILLE)
      REFERENCES VILLES (IDVILLE) ;

